#*
 * Defines a pager. Utilizes 'pager' and 'settings' context variable
 * from the Velocity template being called from.
 *#
#macro (pager $pager)
#* Defines pager appearance. If, for example equals 3, then '<< 1 2 3 ... 'last' >>'
 * will be drawn
 *#
## java.lang.Integer creation to get Integer.parseInt() method
#set($Integer = 0)
## Max number of pages in pager
#set( $maxOnPager = $Integer.parseInt( $settings.get('maxOnPager') ) )
## Number of pages in pager
#set( $pages = $pager.getPageCount() )
## Current page
#set( $active = $pager.getPage() + 1 )
## Current page URL from Apache RequestFacade
#set( $url = $request.getRequestURL() )
<div class="pagination clearfix">  
    <ul class="clearfix">
        #if( $pages gt $maxOnPager )
            ## draw 'spacer' and 'last available page' anchor
            #set( $prev = $url + '?page=prev' )
            <li><a href="$prev">«</a></li>
            #set( $upper_bound = $active + $maxOnPager )
            #foreach ($page in [$active..$upper_bound] )
                #set($page_url = $url + '?page=' + $page + '&search_id=' + $search_id )
                <li><a href="$page_url" class="#if($page eq $active)current#end active">$page</a></li>
            #end
            <li class="spacer">…</li>
            #set( $last = $pages - 1)
            #set( $last_url = $url + '?page=' + $last + '&search_id=' + $search_id )
            <li><a href="$last_url">$last</a></li>   
            #set( $next = $url + '?page=next' + '&search_id=' + $search_id )
            <li><a href="$next">»</a></li>
        #{else}
            ## draw all page's anchors
            #set( $prev = $url + '?page=prev' + '&search_id=' + $search_id )
            <li><a href="$prev">«</a></li>        
            #foreach( $page in [1..$pages] )
                #set($page_url = $url + '?page=' + $page + '&session_id=' +$search_id )
                <li><a href="$page_url" class="#if($page eq $active)current#end active">$page</a></li>
            #end
            #set( $next = $url + '?page=next' + '&search_id=' + $search_id )
            <li><a href="$next">»</a></li>
        #end
    </ul>
</div>
#end